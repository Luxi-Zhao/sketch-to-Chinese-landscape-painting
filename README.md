# Sketch to Chinese Landscape Painting 

This is the repository of project **Sketch to Chinese Landscape Painting**. It contains datasets, code and pre-trained models.  

## /dataset
The dataset folder contains 3 datasets. The `sketch` folder contains sketch images generated by `PhotoSketch` model stored in `preparation` folder [3]. The `hed` folder contains HED edge maps [2]. The `painting` folder contains selected original paintings [1]. 

## /src
### sketch2hed
The notebook and code in `sketch2hed` folder contain training procedure for Pix2Pix model `sketch2hed` [5]. By following the instruction from notebooks, the training can be initialized. 
### hed2paint
The `hed2paint` folder consists of notebooks for training the 2nd Pix2Pix model, `hed2paint`. 
- hed2paint.ipynb -> train a Pix2Pix model on (edge map, painting) pairs.
- hed2paint_predict.ipynb -> run a pre-trained model on a set of edge maps to get stylized images.

Notebooks can be directly loaded into Colab. No additional set up required.
### pytorch-fid
This folder contains the code for computing FID score [4].

## /model
The `model` folder contains our pre-trained models. Since the pre-trained models are too large to be directly uploaded, they are all zipped and split into smaller pieces. To use the pre-trained models, first run `zip -s 0 MODEL.zip --out combined_model.zip`, then run `unzip combined_model.zip`.

## References

[1]  A. Xue, “End-to-end chinese landscape painting creation using generative adversarial networks,”2020.

[2]  S. Xie and Z. Tu, “Holistically-nested edge detection,” 2015.

[3]  M. Li, Z. Lin, R. M&#x011B;ch, , E. Yumer, and D. Ramanan, “Photo-sketching: Inferring contour drawings from images,”WACV, 2019.

[4]  M. Seitzer,  “pytorch-fid:  FID Score for PyTorch,”, version 0.1.1., 2020.

[5]  J.-Y. Zhu,  T. Park,  P. Isola,  and A. A. Efros,  “Unpaired image-to-image translation using cycle-consistent adversarial networks,” in Computer Vision (ICCV), 2017 IEEE InternationalConference on, 2017.
